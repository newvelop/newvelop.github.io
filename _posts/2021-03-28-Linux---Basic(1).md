---
date: 2021-03-29 02:29:39
layout: post
title: "Linux-Basic"
subtitle:
description:
image:
optimized_image:
category:
tags:
- linux
author: newvelop
paginate: false
---
리눅스의 기본 개념에 대해서 정리해본다.

### 리눅스
리눅스는 단순히 말해서 OS이다. 하드웨어 위에서 사용자가 이용할 수 있게 도와주는 운영체제라고 생각하면 된다. 
  ![screensh](../assets/img/2021-03-28-Linux---Basic(1)/linux-architecture.png)
리눅스는 사용자가 사용할 수 있는 시스템 제공 어플리케이션과 리눅스 커널로 이루어져 있다.

리눅스 커널은 리눅스의 핵심 기능으로 하드웨어와 소프트웨어를 이어주는 인터페이스이다. 다른 글을 참고한 결과 커널의 핵심기능은 다음과 같음을 확인하였다.

- 메모리 관리: 메모리가 어디에서 무엇을 저장하는 데 얼마나 사용되는지를 추적한다.
- 프로세스 관리: 어느 프로세스가 중앙 처리 장치(CPU)를 언제 얼마나 오랫동안 사용할지를 결정한다.
- 장치 드라이버: 하드웨어와 프로세스 사이에서 중재자/인터프리터의 역할을 수행한다.
- 시스템 호출 및 보안: 프로세스의 서비스 요청을 수신한다.

대표적인 리눅스 제품으로는 redhat과 ubuntu가 있다. 

### 리눅스 디렉토리 구조
리눅스의 기본 시스템 디렉토리 구조는 다음과 같다.

- / : 루트 디렉토리로 파일 시스템의 최상위이다.
- /bin : 바이너리와 실행가능한 프로그램들이 들어있는 디렉토리이다.
- /etc : 시스템 설정 파일들이 담겨있는 디렉토리이다.
- /home : 홈 디렉토리이다.
- /opt : 서드파티 프로그램들이 담겨있는 디렉토리이다.
- /tmp : 임시 파일들이 담겨있는 디렉토리로 리부팅시 삭제된다.
- /usr : 사용자 관련 프로그램이 담겨있는 디렉토리이다.
- /var : 대부분 로그 파일이 담겨있는 디렉토리이다.

디렉토리 관련하여 컨벤션이 몇 가지 있다고 한다.

- /usr/local 디렉토리에 프로그램을 설치할 경우
  - /usr/local/{사용자 프로그램} : 프로그램 루트 디렉토리
  - /usr/local/{사용자 프로그램}/bin : 프로그램의 바이너리/실행 파일 디렉토리
  - /usr/local/{사용자 프로그램}/etc : 프로그램의 설정 파일 디렉토리
  - /usr/local/{사용자 프로그램}/lib : 프로그램의 라이브러리 디렉토리
  - /usr/local/{사용자 프로그램}/logs : 프로그램의 로그 파일 디렉토리

- /opt 디렉토리에 프로그램을 설치할 경우
  - /opt/{사용자 프로그램} : 프로그램 루트 디렉토리
    - /opt/{사용자 프로그램}/bin : 프로그램의 바이너리/실행 파일 디렉토리
    - /opt/{사용자 프로그램}/etc : 프로그램의 설정 파일 디렉토리
    - /opt/{사용자 프로그램}/lib : 프로그램의 라이브러리 디렉토리
    - /opt/{사용자 프로그램}/logs : 프로그램의 로그 파일 디렉토리

/opt/{사용자 프로그램}의 경우는 /etc/opt/{사용자 프로그램}이나 /var/opt/{사용자 프로그램}과 같은 컨벤션이다. /etc의 경우 설정파일 디렉토리 개념이라 했으니 /etc/opt/{사용자 프로그램}의 경우는 사용자 프로그램의 설정 디렉토리이며, /var/opt/{사용자 프로그램}은 사용자 프로그램의 로그 디렉토리라고 보면 된다.

회사나 팀의 개념이 도입될 경우는 /opt/{회사} 나 /opt/{회사}/팀 이정도로 디렉토리가 생성되는것이 일반적인 컨벤션이라고 한다.

### 쉘
쉘은 리눅스에서 제공하는 기본적인 사용자 인터페이스라고 생각하면된다. 사용자는 쉘을 이용하여 시스템에 명령을 내릴 수 있다.

cli만 제공하는 리눅스의 경우나 gui에서 터미널을 오픈했을 경우 하단과 같은 프롬프트 창을 확인할 수 있다.
![screensh](../assets/img/2021-03-28-Linux---Basic(1)/linux-prompt.png)
프롬프트의 라인 좌측에는 {사용자 명}@{서버명}으로 구성되며, $표시는 일반 사용자임을, # 표시일 경우는 슈퍼 사용자임을 나타낸다.

'~'기호의 경우, home 디렉토리를 요약하는 기호이다.

쉘에서 사용하는 기본 명령어들은 아래와 같다
- ls : 현재 디렉토리의 요소들 표시
- cd : 디렉토리 이동
- pwd : 현재 디렉토리 경로 표시
- cat : 파일의 내용 표시
- echo : 파라미터를 화면에 표시
- man : 매뉴얼 표시
- exit : 쉘 종료
- clear : 현재 화면 초기화

echo의 사용법은 'echo $변수명'을 입력하면 해당 변수명을 가진 값이 출력된다. 일반적으로 변수명은 대문자로만 구성된다
which의 경우 뒤의 파라미터로 넘어오는 커맨드의 위치를 출력한다.
또한 명령어의 사용법을 알고싶을 경우 man을 이용하여 사용법을 보거나 --help나 -h를 명령어 뒤에 입력한다. 
man -k 옵션의 경우, 뒤에 넘어오는 파라미터와 일치하는 매뉴얼 검색 결과들을 보여준다.

#### 디렉토리관련 명령어
- . : 현재 디렉토리
- .. : 상위 디렉토리

윈도우의 경우 경로를 구분하는 구분자는 \ 이지만, 리눅스는 /로 구분한다

echo $PATH를 입력할 경우, 여러가지 결로들이 출력되는데 이는 PATH라는 변수에 담긴 경로들을 의미한다. 리눅스의 커맨드는 해당 경로들을 바탕으로 탐색을 해서, 입력한 커맨드에 맞는 프로그램을 찾아 실행하는 것이다. 추가적으로 현재 쉘이 위치한 디렉토리는 PATH에 들어가기 때문에 경로 표시없이 명령어를 실행해도, 현재 디렉토리에 있을 경우 실행이 되는 것이다.

![screensh](../assets/img/2021-03-28-Linux---Basic(1)/echo-path.png)

- mkdir : 디렉토리 생성
  - -p 옵션을 줄경우, 생성하고자 하는 디렉토리의 부모 디렉토리가 없을 경우 자동으로 생성해줌
- rmdir : 디렉토리 삭제
- rm -rf : 지정된 디렉토리와 하위 파일들 모두 삭제

#### 파일 리스트 관련 명령어
- ls : 파일 리스트 보여주는 명령어
  - -l : 권한, 링크, 소유주 등 상세 정보를 보여줌
  - -a : 숨겨진 파일까지 보여줌(숨김파일은 .으로 파일명이 시작함)
  - -F : 파일의 타입을 보여줌. 파일명 뒤에 / 가 붙으면 디렉토리, @면 링크, *이면 실행가능한 파일

- tree : 트리 형태로 디렉토리 보여줌

디렉토리나 파일명을 지을때 공백을 사이에 넣지 않는 것이 일반적인 컨벤션이라고 한다.

#### 권한
파일이나 폴더의 권한의 형태는 '-123456789' 이런 자리수로 표시가 된다. 하나씩 살펴보면 맨 앞자리의 -는 파일의 타입을 뜻한다. - 일 경우 단순한 파일, d일 경우 디렉토리, l일 경우 링크이다. 123은 파일의 소유권자가 가진 해당 파일에 대한 권한이고, 456은 파일의 그룹이 가진 권한, 789는 일반 사용자의 권한이다. 147의 경우는 읽기 권한 자리이며, 258은 쓰기 권한, 369는 실행권한이다.

- chmod : 파일의 권한을 변경하는 명령어
  - ugoa : 사용자의 카테고리를 뜻함. user, group, other, all
  - +-= : 권한의 더하기 빼기, 세팅을 뜻함
ex) chmod g+w file : 해당 파일의 사용자 그룹에게 쓰기 권한을 부여

읽기, 쓰기, 실행하기 권한을 수로 표현을 하면, 십진법의 경우 4, 2, 1에 각각 해당한다. 이진법의 경우 자리의 위치로 알수 있으며 on이면 1으로, off면 0으로 대응한다

- chgrp : 파일의 사용자 권한을 변경하는 명령어. 파일을 새로 생성하면 현재 사용자의 그룹이 파일의 그룹으로 기본적으로 할당되며 이를 변경하고자 할때 사용하는 명령어

파일에 권한을 제대로 부여했는데도 기대대로 동작을 하지 않는다면, 해당 디렉토리의 권한을 확인해볼것

- umask : 파일이나 디렉토리를 생성할때 권한을 따로 부여하지 않을 경우 기본적으로 부여하는 권한을 계산하기 위한 값. 기본적으로 umask는 0022로 되어있음. 부여할 수 있는 최대 권한 - umask 값이 기본적으로 파일과 디렉토리에 부여되는 값이다.
  - -S : 10진수의 값을 rwx로 보여줌
  - ex) umask가 0022라면 파일의 기본 최대 권한은 666이다. 666 - 022 = 644로 되어서 사용자는 읽고 쓰기 가능, 그룹은 읽기만, 모든 사용자도 읽기만 가능하게 된다. 디렉토리의 경우, 기본 최대 권한은 777이기 때문에 777- 022 = 755가 된다.

추가적으로 파일 실행권한을 부여하고 싶으면, 'chmod u+x 파일명' 을 실행하면 된다.

일반적으로 user, group, other로 000 세글자가 권한이나, 예외적으로 0000이라는 4글자 표시가 있다. 이를 special mode라고 한다.
setuid, setgid, sticky bit가 맨 앞글자에 표현이 되며, 이는 각각 4, 2, 1에 매핑이 된다. setuid의 경우, 활성화 시키면 해당 파일이 실행되었을 때 유효사용자가 해당 파일 실행한사람이 아닌, 파일의 소유자로 변경된다. 예를들어 setuid가 활성화 되었을때, 실행하고자 하는 파일의 소유자가 root일 경우, 일반사용자가 해당 파일을 실행한다고 해도 root 권한으로 실행이 된다는 소리이다. setgid는 setuid의 내용이 그룹으로 적용된다고 보면된다. sticky 비트는 활성화되면 모든 사용자들이 자유롭게 사용하고 접근 가능하지만, 해당 디렉토리에 있는 파일이나, 적용된 파일에 대해서 소유자나 슈퍼유저가 아닐 경우 삭제 및 수정이 불가능하다.



참고
- https://www.redhat.com/ko/topics/linux/what-is-the-linux-kernel
- linux-administration-bootcamp 강의
- https://idchowto.com/?p=42667